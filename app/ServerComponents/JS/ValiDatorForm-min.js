var FormValid=function(frm){this.frm=frm;this.errMsg=new Array();this.errName=new Array();this.required=function(inputObj){if(typeof(inputObj)=="undefined"||inputObj.value.trim()==""){return false}return true},this.checked=function(inputObj){return inputObj.checked},this.equal=function(inputObj,formElements){var fstObj=inputObj;var sndObj=formElements[inputObj.getAttribute("eqaulName")];if(fstObj!=null&&sndObj!=null){if(fstObj.value!=sndObj.value){return false}}return true};this.gt=function(inputObj,formElements){var fstObj=inputObj;var sndObj=formElements[inputObj.getAttribute("eqaulName")];if(fstObj!=null&&sndObj!=null&&fstObj.value.trim()!=""&&sndObj.value.trim()!=""){if(parseFloat(fstObj.value)<=parseFloat(sndObj.value)){return false}}return true};this.compare=function(inputObj,formElements){var fstObj=inputObj;var sndObj=formElements[inputObj.getAttribute("objectName")];if(fstObj!=null&&sndObj!=null&&fstObj.value.trim()!=""&&sndObj.value.trim()!=""){if(!(eval(parseFloat(fstObj.value)+inputObj.getAttribute("operate")+parseFloat(sndObj.value)))){return false}}return true};this.comparedate=function(inputObj,formElements){var startdate=inputObj.value;var enddate=formElements[inputObj.getAttribute("compareName")].value;startdate=startdate.replace(/-/g,"/");enddate=enddate.replace(/-/g,"/");enddate=Date.parse(enddate);startdate=Date.parse(startdate);if(startdate-enddate>-1){return false}else{return true}};this.limitDate=function(inputObj){var len=inputObj.value.length;if(len){var minDate=Date.parse(inputObj.getAttribute("mindate").replace(/-/g,"/"));var currDate=Date.parse(inputObj.value.replace(/-/g,"/"));if(minDate-currDate>-1){return false}return true}return true};this.limit=function(inputObj){var len=inputObj.value.length;if(len){var minv=parseInt(inputObj.getAttribute("min"));var maxv=parseInt(inputObj.getAttribute("max"));minv=minv||0;maxv=maxv||Number.MAX_VALUE;return minv<=len&&len<=maxv}return true};this.range=function(inputObj){var val=parseInt(inputObj.value);if(inputObj.value){var minv=parseInt(inputObj.getAttribute("min"));var maxv=parseInt(inputObj.getAttribute("max"));minv=minv||0;maxv=maxv||Number.MAX_VALUE;return minv<=val&&val<=maxv}return true},this.requiredSelected=function(selectObj,formElements){var minv=parseInt(selectObj.getAttribute("min"));var maxv=parseInt(selectObj.getAttribute("max"));minv=minv||0;maxv=maxv||Number.MAX_VALUE;var selectedCount=0,isSelected=false;for(var i=0;i<selectObj.options.length;i++){isSelected=selectObj.options[i].selected;if(isSelected){selectedCount++}}return minv<=selectedCount&&selectedCount<=maxv},this.requiredRadioed=function(inputObj,formElements){var groups=document.getElementsByName(inputObj.name);var isChecked=false;for(var i=0;i<groups.length;i++){if(groups[i].checked){isChecked=true;break}}return isChecked},this.requireChecked=function(inputObj,formElements){var minv=parseInt(inputObj.getAttribute("min"));var maxv=parseInt(inputObj.getAttribute("max"));var arrayName=null;var pos=inputObj.name.indexOf("[");if(pos!=-1){arrayName=inputObj.name.substr(0,pos)}minv=minv||1;maxv=maxv||Number.MAX_VALUE;var checked=0;if(!arrayName){var groups=document.getElementsByName(inputObj.name);for(var i=0;i<groups.length;i++){if(groups[i].checked){checked++}}}else{for(var i=0;i<formElements.length;i++){var e=formElements[i];if(e.checked==true&&e.type=="checkbox"&&e.name.substring(0,arrayName.length)==arrayName){checked++}}}return minv<=checked&&checked<=maxv};this.filter=function(inputObj){var value=inputObj.value;var allow=inputObj.getAttribute("allow");if(value.trim()){return new RegExp("^.+.(?=EXT)(EXT)$".replace(/EXT/g,allow.split(/\s*,\s*/).join("|")),"gi").test(value)}return true};this.isNo=function(inputObj){var value=inputObj.value;var noValue=inputObj.getAttribute("noValue");return value!=noValue};this.isTelephone=function(inputObj){inputObj.value=inputObj.value.trim();if(inputObj.value==""){return true}else{if(!RegExps.isMobile.test(inputObj.value)&&!RegExps.isPhone.test(inputObj.value)){return false}}return true};this.checkReg=function(inputObj,reg,msg){inputObj.value=inputObj.value.trim();if(inputObj.value==""){return true}else{return reg.test(inputObj.value)}};this.passed=function(errMode){if(this.errMsg.length>0){if(errMode=="span"){FormValid.showError(this.errMsg,this.errName,this.frm.name)}if(errMode=="alert"){FormValid.alertError(this.errMsg)}if(this.errName[0].indexOf("[")==-1){frt=document.getElementById(this.errName[0]);if(frt!=null){if(frt.type=="text"||frt.type=="password"||frt.type=="select-one"){frt.focus()}}else{var obj=document.getElementById("errMsg_"+this.errName[0]);if(obj!=null){try{obj.focus()}catch(e){}}}}return false}else{return FormValid.succeed(this.frm.name)}};this.addErrorMsg=function(name,str){this.errMsg.push(str);this.errName.push(name)};this.addAllName=function(name){FormValid.allName.push(name)}};FormValid.allName=new Array();FormValid.alertError=function(a){var b="";for(i=0;i<a.length;i++){b+="- "+a[i]+"\n"}alert(b)};FormValid.showError=function(d,a,c){for(var b=0;b<d.length;b++){$("#errMsg_"+a[b]).html(d[b])}};FormValid.succeed=function(){return true};var ValiDatorForm={validator:function(l,h,m){this.ClearerrMsg(l);var b=l.elements;var d=new FormValid(l);FormValid.allName=new Array();for(var e=0;e<b.length;e++){var g;if(m!=null){if(b[e].id.indexOf(m)<0){g=b[e]}}else{g=b[e]}if(g!=null){var k=this.fvCheck(g,d,b);var a=g.getAttribute("errmsgend");if(a==null){a=g.id}if(k.length>0){for(var c=0;c<k.length;c++){d.addErrorMsg(a,k[c])}}}}return d.passed(h)},CheckValidator:function(e,d,f,c,b){var a=this;if(!e.checked){document.getElementById(b).style.display="none";FV_onBlur.initValid(d,c);d.onsubmit=function(){return a.validator(d,f,c)};this.ClearerrMsg(d,c)}else{document.getElementById(b).style.display="";FV_onBlur.initValid(d);d.onsubmit=function(){return a.validator(d,f)}}},ClearerrMsg:function(d,a){var c;for(var b=0;b<d.length;b++){if(d[b].id.indexOf(a)>-1){c=d[b].getAttribute("errmsgend");if(c==null){c=d[b].id}var e=document.getElementById("errMsg_"+c);if(e!=null){e.innerHTML="";d[b].onblur=null}}}},ClearerrMsg:function(c){var b;for(var a=0;a<c.length;a++){b=c[a].getAttribute("errmsgend");if(b==null){b=c[a].id}var d=document.getElementById("errMsg_"+b);if(d!=null){d.innerHTML=""}}},fvCheck:function(e,fv,formElements){var validType=e.getAttribute("valid");var errorMsg=e.getAttribute("errmsg");if(!errorMsg){errorMsg=""}if(validType==null){return[]}fv.addAllName(e.id);var vts=validType.split("|");var ems=errorMsg.split("|");var r=[];for(var j=0;j<vts.length;j++){var curValidType=vts[j];var curErrorMsg=ems[j];var validResult;switch(curValidType){case"isNumber":case"isEmail":case"isPhone":case"isMobile":case"isIdCard":case"isMoney":case"isZip":case"isQQ":case"isInt":case"isEnglish":case"isChinese":case"isUrl":case"isDate":case"isTime":case"RegInteger":validResult=fv.checkReg(e,RegExps[curValidType],curErrorMsg);break;case"regexp":validResult=fv.checkReg(e,new RegExp(e.getAttribute("regexp"),"g"),curErrorMsg);break;case"custom":validResult=eval(e.getAttribute("custom")+"(e,formElements)");break;default:validResult=eval("fv."+curValidType+"(e,formElements)");break}if(!validResult){r.push(curErrorMsg)}}return r}};String.prototype.trim=function(){return this.replace(/^\s*|\s*$/g,"")};var RegExps=function(){};RegExps.isNumber=/^[-\+]?\d+(\.\d+)?$/;RegExps.isEmail=/([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)/;RegExps.isPhone=/^((\(\d{2,3}\))|(\d{3}\-))?(\(0\d{2,3}\)|0\d{2,3}-?)?[1-9]\d{6,7}(\-\d{1,4})?$/;RegExps.isMobile=/^((\(\d{2,3}\))|(\d{3}\-))?(13|15|18)\d{9}$/;RegExps.isIdCard=/(^\d{15}$)|(^\d{17}[0-9Xx]$)/;RegExps.isMoney=/^\d+(\.\d+)?$/;RegExps.isZip=/^[1-9]\d{5}$/;RegExps.isQQ=/^[1-9]\d{4,10}$/;RegExps.isInt=/^[-\+]?\d+$/;RegExps.isEnglish=/^[A-Za-z]+$/;RegExps.isChinese=/^[\u0391-\uFFE5]+$/;RegExps.isUrl=/^http[s]?:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/;RegExps.isDate=/^\d{4}-\d{1,2}-\d{1,2}$/;RegExps.isTime=/^\d{4}-\d{1,2}-\d{1,2}\s\d{1,2}:\d{1,2}:\d{1,2}$/;RegExps.RegInteger=/^[0-9]+$/;
